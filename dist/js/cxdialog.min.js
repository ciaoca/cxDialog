/**
 * cxDialog
 * @version 2.0.0
 * @author ciaoca
 * @email ciaoca@gmail.com
 * @site https://github.com/ciaoca/cxDialog
 * @license Released under the MIT license
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).cxDialog=t()}(this,(function(){"use strict";const e={dom:{},settings:{},queue:[],lock:!1,isElement:function(e){return!(!e||"function"!=typeof HTMLElement&&"object"!=typeof HTMLElement||!(e instanceof HTMLElement))||!(!e||!e.nodeType||1!==e.nodeType)},isObject:function(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)&&!(e.constructor&&!Object.prototype.hasOwnProperty.call(e.constructor.prototype,"isPrototypeOf"))},extend:function(e,...t){const o=this;if(o.isObject(e)){for(let n of t)if(o.isObject(n))for(let t in n)Array.isArray(n[t])?e[t]=[].concat(n[t]):o.isObject(n[t])?(o.isObject(e[t])||(e[t]={}),o.extend(e[t],n[t])):e[t]=n[t];return e}},init:function(){this.buildStage(),this.bindEvent()},buildStage:function(){const e=this;e.dom.wrap=document.createElement("div"),e.dom.wrap.classList.add("cxdialog"),e.dom.box=document.createElement("div"),e.dom.box.classList.add("cxdialog_box"),e.dom.mask=document.createElement("div"),e.dom.mask.classList.add("cxdialog_mask"),e.dom.holder=document.createElement("div"),e.dom.holder.classList.add("cxdialog_holder"),e.dom.wrap.insertAdjacentElement("beforeend",e.dom.mask),e.dom.wrap.insertAdjacentElement("beforeend",e.dom.box),document.body.insertAdjacentElement("beforeend",e.dom.wrap)},bindEvent:function(){const e=this;e.dom.mask.addEventListener("click",(()=>{e.settings.maskClose&&e.exit()})),e.dom.wrap.addEventListener("click",(t=>{const o=t.target;let n;if("a"===o.nodeName.toLowerCase()&&"cxdialog"===o.rel){if(event.preventDefault(),Array.isArray(e.cacheBtnFun)&&e.cacheBtnFun.length)for(let t of e.cacheBtnFun)if(t.name===o.rev&&"function"==typeof t.callback){n=t.callback();break}!1!==n&&e.exit()}}))},setContent:function(){const e=this,t=(new Date).getTime();let o="";e.dom.box.innerHTML="","string"==typeof e.settings.title&&e.settings.title.length&&(o+='<div class="cxdialog_title">'+e.settings.title+"</div>"),"string"==typeof e.settings.info?o+='<div class="cxdialog_info">'+String(e.settings.info)+"</div>":e.isElement(e.settings.info)&&e.fillDom(),e.cacheBtnFun=[];for(let t of["ok","no"])"function"==typeof e.settings[t]&&e.cacheBtnFun.push({name:t,className:t,text:e.settings[t+"Text"],callback:e.settings[t]});for(let o=0,n=e.settings.buttons.length;o<n;o++)e.cacheBtnFun.push({name:"btn_"+t+"_"+o,className:"btn_"+o,text:e.settings.buttons[o].text,callback:e.settings.buttons[o].callback});if(e.cacheBtnFun.length){o+='<div class="cxdialog_btns">';for(let t of e.cacheBtnFun)o+='<a class="'+t.className+'" rel="cxdialog" rev="'+t.name+'">'+t.text+"</a>";o+="</div>"}e.dom.box.insertAdjacentHTML("beforeend",o),e.cacheDom&&(e.dom.box.querySelector(".cxdialog_title")?e.dom.box.querySelector(".cxdialog_title").insertAdjacentElement("afterend",e.cacheDom.el):e.dom.box.insertAdjacentElement("afterbegin",e.cacheDom.el))},fillDom:function(){const e=this;e.cacheDom={el:e.settings.info,hasHolder:!1};const t=e.cacheDom.el.getAttribute("style");"string"==typeof t&&(e.cacheDom.styleText=t);const o=window.getComputedStyle(e.cacheDom.el),n=["visibility:hidden","border-style:solid","border-color:transparent"],i=o.getPropertyValue("display");if("string"==typeof i&&i.length){for(let e of["display","position","float","flex","width","height","margin","padding","border-width"]){const t=o.getPropertyValue(e);"string"==typeof t&&t.length&&n.push([e,t].join(":"))}e.dom.holder.setAttribute("style",n.join(";")),e.cacheDom.el.insertAdjacentElement("afterend",e.dom.holder),e.cacheDom.hasHolder=!0}},backDom:function(){const e=this;if(!e.cacheDom||!e.isElement(e.cacheDom.el))return;const t=window.getComputedStyle(e.cacheDom.el),o=["visibility:hidden","border-style:solid","border-color:transparent"];for(let e of["width","height","margin","padding","border-width"]){const n=t.getPropertyValue(e);"string"==typeof n&&n.length&&o.push([e,n].join(":"))}e.dom.holder.setAttribute("style",o.join(";")),e.cacheDom.hasHolder&&(e.dom.holder.insertAdjacentElement("afterend",e.cacheDom.el),e.dom.holder.parentNode.removeChild(e.dom.holder)),e.dom.box.querySelector(".cxdialog_title")?e.dom.box.querySelector(".cxdialog_title").insertAdjacentElement("afterend",e.dom.holder):e.dom.box.insertAdjacentElement("afterbegin",e.dom.holder),"string"==typeof e.cacheDom.styleText&&e.cacheDom.styleText.length?e.cacheDom.el.setAttribute("style",e.cacheDom.styleText):e.cacheDom.el.removeAttribute("style"),e.dom.box.contains(e.cacheDom.el)&&e.dom.box.removeChild(e.cacheDom.el),e.cacheDom=null},show:function(e){const o=this,n=["cxdialog","in"];o.lock=!0,o.settings=o.extend({},t.defaults,e),"string"==typeof o.settings.baseClass&&o.settings.baseClass.length&&n.push(o.settings.baseClass),o.setContent(),o.dom.wrap.className=n.join(" ")},exit:function(){const e=this;e.backDom(),e.lock=!1,e.cacheBtnFun=null,e.dom.wrap.classList.remove("in"),e.dom.wrap.classList.add("out"),e.next()},add:function(e,t,o){const n=this,i={};"string"==typeof e||n.isElement(e)?i.info=e:n.isObject(e)?Object.assign(i,e):null!=e&&(i.info=String(e)),"function"==typeof t&&(i.ok=t),"function"==typeof o&&(i.no=o),n.queue.push(i),n.next()},next:function(){const e=this;e.lock||e.queue.length&&e.show(e.queue.shift())}};document.addEventListener("DOMContentLoaded",(()=>{e.init()}));const t=function(){e.add(...arguments)};return t.close=function(){e.exit.apply(e)},t.defaults={title:void 0,info:void 0,ok:void 0,no:void 0,okText:"确 定",noText:"取 消",buttons:[],baseClass:void 0,maskClose:!0},t}));
