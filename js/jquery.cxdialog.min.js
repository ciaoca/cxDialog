/*!
 * jQuery cxDialog 1.2.1
 * http://code.ciaoca.com/
 * https://github.com/ciaoca/cxDialog
 * E-mail: ciaoca@gmail.com
 * Released under the MIT license
 * Date: 2015-01-13
 *
 * 简易调用：$.cxDialog(string, [ok, no])
 * 完整方法：$.cxDialog(opt)
 * @param {object|string} opt 参数设置 or 内容
 *   title {string} 标题
 *   info {string|dom} 内容
 *   ok {fn} 点击确认时的回调函数
 *   okText {string} 确认按钮文字
 *   no {fn} 点击取消时的回调函数
 *   noText {string} 取消按钮文字
 *   buttons {array} 自定义按钮：[{text: 'text', callback: fn}, ...]
 *   closeBtn {boolean} 是否显示关闭按钮
 *   lockScroll {boolean} 是否锁定滚动
 *   baseClass {string} 给对话框容器增加 class，不会覆盖默认的 class
 *   background {string} 遮罩背景的颜色，留空表示不需要遮罩
 *   width {int} 提示框固定宽度
 *   height {int} 提示框固定高度
 *   zIndex {int} 提示框的层级
 *
 * @param {function} ok 点击确认时的回调函数
 * @param {function} no 点击取消时的回调函数
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(window.jQuery||window.Zepto||window.$)}(function(a){var b,c,d;("function"==typeof Zepto||"object"==typeof Zepto)&&(b=function(a,b){return function(c){var d,e,f;return this?(f=this,e=f[a](),d={width:["left","right"],height:["top","bottom"]},d[a].forEach(function(a){e+=parseInt(f.css("padding-"+a),10),b&&(e+=parseInt(f.css("border-"+a+"-width"),10)),c&&(e+=parseInt(f.css("margin-"+a),10))}),e):null}},["width","height"].forEach(function(a){var c=a.substr(0,1).toUpperCase()+a.substr(1);Zepto.fn["inner"+c]=b(a,!1),Zepto.fn["outer"+c]=b(a,!0)})),c=!!window.ActiveXObject&&!window.XMLHttpRequest,d={dom:{},isElement:function(a){return a&&("function"==typeof HTMLElement||"object"==typeof HTMLElement)&&a instanceof HTMLElement?!0:a&&a.nodeType&&1===a.nodeType?!0:!1},isJquery:function(a){return a&&a.length&&("function"==typeof jQuery||"object"==typeof jQuery)&&a instanceof jQuery?!0:!1},isZepto:function(a){return a&&a.length&&("function"==typeof Zepto||"object"==typeof Zepto)&&Zepto.zepto.isZ(a)?!0:!1}},d.init=function(){var e=this;e.dom.docHtml=a("html"),e.dom.box=a("<div></div>",{id:"cxdialog","class":"cxdialog"}),e.dom.overlay=a("<div></div>",{id:"cxdialog_overlay","class":"cxdialog_overlay"}),e.dom.holder=a("<div></div>",{id:"cxdialog_holder","class":"cxdialog_holder"}),e.dom.title=a("<div></div>",{"class":"cxdialog_title"}),e.dom.info=a("<div></div>",{"class":"cxdialog_info"}),e.dom.btns=a("<div></div>",{"class":"cxdialog_btns"}),e.dom.closeBtn=a("<a></a>",{rel:"cxdialog",rev:"close"}),e.dom.box.on("click","a",function(){var c,d,f,a=this.rel,b=this.rev;if("cxdialog"===a){if("close"===b)e.exit();else for(d=0,f=e.btnCache.length;f>d;d++)if(e.btnCache[d].name===b&&"function"==typeof e.btnCache[d].callback){c=e.btnCache[d].callback();break}return c!==!1&&e.exit(),!1}})},d.format=function(b,c,d){var e=this;if(e.exit(),"string"!=typeof b||b.length){if("string"==typeof b||e.isElement(b)||e.isJquery(b)||e.isZepto(b))b={info:b};else if("object"!=typeof b)return;"function"==typeof c&&(b.ok=c),"function"==typeof d&&(b.no=d),b=a.extend({},a.cxDialog.defaults,b),e.setContent(b),e.show(b)}},d.setContent=function(b){var e,f,g,h,i,j,c=this,d=(new Date).getTime();for("string"==typeof b.title&&b.title.length&&c.dom.title.html(b.title).appendTo(c.dom.box),c.infoCache=void 0,"string"==typeof b.info&&b.info.length?c.dom.info.html(b.info).appendTo(c.dom.box):c.isElement(b.info)||c.isJquery(b.info)||c.isZepto(b.info)?(c.infoCache=c.isElement(b.info)?a(b.info):b.info,e=c.infoCache.css("float"),f=c.infoCache.css("display"),g=c.infoCache.css("visibility"),c.dom.holder.css({"float":e,display:f,visibility:g,width:c.infoCache.outerWidth(),height:c.infoCache.outerHeight()}).data({"float":e,display:f,visibility:g}).insertAfter(c.infoCache),c.infoCache.show().appendTo(c.dom.box)):(b.info=String(b.info),c.dom.info.html(b.info).appendTo(c.dom.box)),c.btnCache=[],"function"==typeof b.ok&&c.btnCache.push({name:"btn_ok",className:"btn_ok",text:b.okText,callback:b.ok}),"function"==typeof b.no&&c.btnCache.push({name:"btn_no",className:"btn_no",text:b.noText,callback:b.no}),h=0,i=b.buttons.length;i>h;h++)c.btnCache.push({name:"btn_"+d+"_"+h,className:"btn_"+h,text:b.buttons[h].text,callback:b.buttons[h].callback});if(c.btnCache.length){for(j="",h=0,i=c.btnCache.length;i>h;h++)j+='<a class="'+c.btnCache[h].className+'" rel="cxdialog" rev="'+c.btnCache[h].name+'">'+c.btnCache[h].text+"</a>";c.dom.btns.html(j).appendTo(c.dom.box)}b.closeBtn&&c.dom.closeBtn.appendTo(c.dom.box)},d.show=function(a){var d,b=this;b.dom.box.appendTo("body"),a.lockScroll===!0&&b.dom.docHtml.addClass("cxdialog_lock"),a.background.length&&b.dom.overlay.css("background",a.background).appendTo("body").css("display","block"),b.dom.box.css("display","block"),"string"==typeof a.baseClass&&a.baseClass.length&&b.dom.box.addClass(a.baseClass),d={},c&&(d.top=document.documentElement.scrollTop+window.screen.availHeight/4),a.width>0?(d.width=a.width,d.marginLeft=-(a.width/2)):d.marginLeft=-(b.dom.box.outerWidth()/2),a.height>0?(d.height=a.height,d.marginTop=-(a.height/2)):d.marginTop=-(b.dom.box.outerHeight()/2),a.zIndex>0&&(d.zIndex=a.zIndex),b.dom.box.css(d)},d.backDom=function(){var a=this;(a.isJquery(a.infoCache)||a.isZepto(a.infoCache))&&(a.infoCache.css({"float":"",display:"",visibility:""}).insertAfter(a.dom.holder),a.dom.holder.remove())},d.exit=function(){var a=this;a.backDom(),a.infoCache=void 0,a.btnCache=void 0,a.dom.box.attr("class","cxdialog").empty().hide(),a.dom.overlay.hide(),a.dom.docHtml.removeClass("cxdialog_lock")},d.init(),a.cxDialog=function(){d.format.apply(d,arguments)},a.cxDialog.close=function(){d.exit.apply(d)},a.cxDialog.defaults={title:"",info:"",ok:null,okText:"确 定",no:null,noText:"取 消",buttons:[],closeBtn:!0,lockScroll:!1,baseClass:"",background:"",width:0,height:0}});