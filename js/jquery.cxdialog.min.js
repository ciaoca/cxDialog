/*!
 * jQuery cxDialog
 * 
 * @version 1.3.0
 * @author ciaoca@gmail.com
 * @site https://github.com/ciaoca/cxDialog
 * @license Released under the MIT license
 * 
 * @param {object|string|dom} options 参数设置 or 内容
 * @param {string} [options.title] 标题
 * @param {string|dom} [options.info] 内容
 * @param {function} [options.ok] 确认按钮回调函数
 * @param {string} [options.okText] 确认按钮文字
 * @param {function} [options.no] 取消按钮回调函数
 * @param {string} [options.noText] 取消按钮文字
 * @param {array} [options.buttons] 自定义按钮 [{text: 'text', callback: function}, ..]
 * @param {string} [options.buttons.text] 自定义按钮文字
 * @param {function} [options.buttons.callback] 自定义按钮回调函数
 * @param {string} [options.baseClass] 增加自定义 class，不会覆盖默认的 class
 * @param {boolean} [options.maskClose] 背景遮罩是否可以关闭对话框
 *
 * @param {function} [ok] 等同于 options.ok
 * @param {function} [no] 等同于 options.no
 *
 * @example
 * $.cxDialog(string[, ok, no])
 * $.cxDialog(options)
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(window.jQuery||window.Zepto||window.$)}(function(a){var b={dom:{},isElement:function(a){return a&&("function"==typeof HTMLElement||"object"==typeof HTMLElement)&&a instanceof HTMLElement?!0:a&&a.nodeType&&1===a.nodeType?!0:!1},isJquery:function(a){return a&&a.length&&("function"==typeof jQuery||"object"==typeof jQuery)&&a instanceof jQuery?!0:!1},isZepto:function(a){return a&&a.length&&("function"==typeof Zepto||"object"==typeof Zepto)&&Zepto.zepto.isZ(a)?!0:!1}};b.init=function(){var b=this;b.dom.wrap=a("<div></div>",{id:"cxdialog","class":"cxdialog"}),b.dom.box=a("<div></div>",{"class":"box"}),b.dom.mask=a("<div></div>",{"class":"mask"}),b.dom.holder=a("<div></div>",{"class":"cxdialog_holder"}),b.dom.wrap.append(b.dom.mask).append(b.dom.box),b.dom.mask.on("click",function(){this.dataset.close&&b.exit()}),b.dom.wrap.on("click","a",function(){var e,f,g,a=this,c=a.rel,d=a.rev;if("cxdialog"===c){if(event.preventDefault(),"close"===d)b.exit();else if(Array.isArray(b.btnCache)&&b.btnCache.length)for(f=0,g=b.btnCache.length;g>f;f++)if(b.btnCache[f].name===d&&"function"==typeof b.btnCache[f].callback){e=b.btnCache[f].callback();break}e!==!1&&b.exit()}}),document.addEventListener("DOMContentLoaded",function(){b.dom.wrap.appendTo("body")})},b.setOptions=function(b,c,d){var e=this;if("string"==typeof b||e.isElement(b)||e.isJquery(b)||e.isZepto(b))b={info:b};else if("object"!=typeof b)return;"function"==typeof c&&(b.ok=c),"function"==typeof d&&(b.no=d),b=a.extend({},a.cxDialog.defaults,b),e.dom.wrap.attr("class","cxdialog"),e.setContent(b),e.show(b)},b.setContent=function(b){var f,g,h,i,c=this,d="",e=(new Date).getTime();for(c.dom.box.empty(),b.maskClose&&c.dom.mask.data("close",1),"string"==typeof b.title&&b.title.length&&(d+='<div class="title">'+b.title+"</div>"),c.backDom(),"string"==typeof b.info&&b.info.length?d+='<div class="info">'+b.info+"</div>":c.isElement(b.info)||c.isJquery(b.info)||c.isZepto(b.info)?(c.infoCache={dom:c.isElement(b.info)?a(b.info):b.info},f=c.infoCache.dom.css(["display","visibility","position","float","flex","margin","padding","borderWidth"]),g=c.infoCache.dom.attr("style"),c.dom.holder.css({display:f.display,visibility:f.visibility,position:f.position,"float":f.float,flex:f.flex,padding:f.padding,margin:f.margin,borderWidth:f.borderWidth,borderStyle:"solid",borderColor:"transparent",width:c.infoCache.dom.width(),height:c.infoCache.dom.height()}).insertAfter(c.infoCache.dom),"string"==typeof g&&g.length&&(c.infoCache.styleText=g),c.infoCache.dom.css("display","block").appendTo(c.dom.box)):d+='<div class="info">'+String(b.info)+"</div>",c.btnCache=[],"function"==typeof b.ok&&c.btnCache.push({name:"btn_ok",className:"btn_ok",text:b.okText,callback:b.ok}),"function"==typeof b.no&&c.btnCache.push({name:"btn_no",className:"btn_no",text:b.noText,callback:b.no}),h=0,i=b.buttons.length;i>h;h++)c.btnCache.push({name:"btn_"+e+"_"+h,className:"btn_"+h,text:b.buttons[h].text,callback:b.buttons[h].callback});if(c.btnCache.length){for(d+='<div class="btns">',h=0,i=c.btnCache.length;i>h;h++)d+='<a class="'+c.btnCache[h].className+'" rel="cxdialog" rev="'+c.btnCache[h].name+'">'+c.btnCache[h].text+"</a>";d+="</div>"}d+='<a class="close" rel="cxdialog" rev="close"></a>',c.dom.box.html(d),c.infoCache&&c.dom.box.find(".btns").before(c.infoCache.dom)},b.show=function(a){var b=this;"string"==typeof a.baseClass&&a.baseClass.length&&b.dom.wrap.addClass(a.baseClass),b.dom.wrap.addClass("in"),document.body.classList.add("cxdialog_lock")},b.exit=function(){var a=this;a.backDom(),a.btnCache=null,a.dom.wrap.removeClass("in").addClass("out"),document.body.classList.remove("cxdialog_lock")},b.backDom=function(){var a=this;a.infoCache&&(a.isJquery(a.infoCache.dom)||a.isZepto(a.infoCache.dom))&&("string"==typeof a.infoCache.styleText&&a.infoCache.styleText.length?a.infoCache.dom.attr("style",a.infoCache.styleText):a.infoCache.dom.removeAttr("style"),a.infoCache.dom.insertAfter(a.dom.holder),a.dom.holder.remove().removeAttr("style")),a.infoCache=null},a.cxDialog=function(){b.setOptions.apply(b,arguments)},a.cxDialog.close=function(){b.exit.apply(b)},a.cxDialog.defaults={title:"",info:"",ok:null,okText:"确 定",no:null,noText:"取 消",buttons:[],baseClass:"",maskClose:!0},b.init()});